CMAKE_MINIMUM_REQUIRED(VERSION 2.6)
IF(COMMAND CMAKE_POLICY)
  CMAKE_POLICY(VERSION 2.6)
ENDIF(COMMAND CMAKE_POLICY)

PROJECT(ffmpeg)

add_custom_target(ffmpeg ALL WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR})

	set(FFMPEG_INCLUDE ${CMAKE_CURRENT_SOURCE_DIR}/include CACHE INTERNAL "FFMPEG include directories" FORCE)

	set(FFMPEG_AVCODEC_LIB_BASE avcodec-52.lib CACHE INTERNAL "FFPMEG AVCODEC Library base name." FORCE)
	set(FFMPEG_AVDEVICE_LIB_BASE avdevice-52.lib CACHE INTERNAL "FFMPEG AVDEVICE base Library name." FORCE)
	set(FFMPEG_AVFORMAT_LIB_BASE avformat-52.lib CACHE INTERNAL "FFMPEG AVFORMAT base Library name." FORCE)
	set(FFMPEG_AVUTIL_LIB_BASE avutil-50.lib CACHE INTERNAL "FFMPEG AVUTIL Library base name." FORCE)
	set(FFMPEG_SWSCALE_LIB_BASE swscale-0.lib CACHE INTERNAL "FFMPEG SWSCALE Library base name." FORCE)

	set(FFMPEG_AVCODEC_SHARED_BASE avcodec-52.dll CACHE INTERNAL "FFPMEG AVCODEC SHARED base name." FORCE)
	set(FFMPEG_AVDEVICE_SHARED_BASE avdevice-52.dll CACHE INTERNAL "FFMPEG AVDEVICE SHARED base name." FORCE)
	set(FFMPEG_AVFORMAT_SHARED_BASE avformat-52.dll CACHE INTERNAL "FFMPEG AVFORMAT SHARED base name." FORCE)
	set(FFMPEG_AVUTIL_SHARED_BASE avutil-50.dll CACHE INTERNAL "FFMPEG AVUTIL SHARED base name." FORCE)
	set(FFMPEG_SWSCALE_SHARED_BASE swscale-0.dll CACHE INTERNAL "FFMPEG SWSCALE SHARED base name." FORCE)


	add_custom_command(TARGET ffmpeg
			POST_BUILD
			
			COMMAND ${CMAKE_COMMAND} -E make_directory ${CMAKE_BINARY_DIR}/${CMAKE_CFG_INTDIR}
			COMMAND ${CMAKE_COMMAND} -E copy_if_different  ${CMAKE_CURRENT_SOURCE_DIR}/lib/${FFMPEG_AVCODEC_SHARED_BASE} ${CMAKE_BINARY_DIR}/${CMAKE_CFG_INTDIR}
			COMMAND ${CMAKE_COMMAND} -E copy_if_different  ${CMAKE_CURRENT_SOURCE_DIR}/lib/${FFMPEG_AVDEVICE_SHARED_BASE} ${CMAKE_BINARY_DIR}/${CMAKE_CFG_INTDIR}
			COMMAND ${CMAKE_COMMAND} -E copy_if_different  ${CMAKE_CURRENT_SOURCE_DIR}/lib/${FFMPEG_AVFORMAT_SHARED_BASE} ${CMAKE_BINARY_DIR}/${CMAKE_CFG_INTDIR} 
			COMMAND ${CMAKE_COMMAND} -E copy_if_different  ${CMAKE_CURRENT_SOURCE_DIR}/lib/${FFMPEG_AVUTIL_SHARED_BASE} ${CMAKE_BINARY_DIR}/${CMAKE_CFG_INTDIR}
			COMMAND ${CMAKE_COMMAND} -E copy_if_different  ${CMAKE_CURRENT_SOURCE_DIR}/lib/${FFMPEG_SWSCALE_SHARED_BASE} ${CMAKE_BINARY_DIR}/${CMAKE_CFG_INTDIR}
			WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}
	)



set(FFMPEG_AVCODEC_SHARED ${CMAKE_CURRENT_SOURCE_DIR}/lib/${FFMPEG_AVCODEC_SHARED_BASE} CACHE INTERNAL "FFPMEG AVCODEC shared lib name." FORCE)
set(FFMPEG_AVDEVICE_SHARED ${CMAKE_CURRENT_SOURCE_DIR}/lib/${FFMPEG_AVDEVICE_SHARED_BASE} CACHE INTERNAL "FFMPEG AVDEVICE shared lib name." FORCE)
set(FFMPEG_AVFORMAT_SHARED ${CMAKE_CURRENT_SOURCE_DIR}/lib/${FFMPEG_AVFORMAT_SHARED_BASE} CACHE INTERNAL "FFMPEG AVFORMAT shared lib name." FORCE)
set(FFMPEG_AVUTIL_SHARED ${CMAKE_CURRENT_SOURCE_DIR}/lib/${FFMPEG_AVUTIL_SHARED_BASE} CACHE INTERNAL "FFMPEG AVUTIL shared lib name." FORCE)
set(FFMPEG_SWSCALE_SHARED ${CMAKE_CURRENT_SOURCE_DIR}/lib/${FFMPEG_SWSCALE_SHARED_BASE} CACHE INTERNAL "FFMPEG SWSCALE shared lib name." FORCE)

set(FFMPEG_AVCODEC_LIB ${CMAKE_CURRENT_SOURCE_DIR}/lib/${FFMPEG_AVCODEC_LIB_BASE} CACHE INTERNAL "FFMPEG AVCODEC Library name" FORCE)
set(FFMPEG_AVDEVICE_LIB ${CMAKE_CURRENT_SOURCE_DIR}/lib/${FFMPEG_AVDEVICE_LIB_BASE} CACHE INTERNAL "FFMPEG AVDEVICE Library name" FORCE)
set(FFMPEG_AVFORMAT_LIB ${CMAKE_CURRENT_SOURCE_DIR}/lib/${FFMPEG_AVFORMAT_LIB_BASE} CACHE INTERNAL "FFMPEG AVFORMAT Library name" FORCE)
set(FFMPEG_AVUTIL_LIB ${CMAKE_CURRENT_SOURCE_DIR}/lib/${FFMPEG_AVUTIL_LIB_BASE} CACHE INTERNAL "FFMPEG AVUTIL Library name" FORCE)
set(FFMPEG_SWSCALE_LIB ${CMAKE_CURRENT_SOURCE_DIR}/lib/${FFMPEG_SWSCALE_LIB_BASE} CACHE INTERNAL "FFMPEG SWSCALE Library name" FORCE)
set(FFMPEG_LIBRARIES ${FFMPEG_AVCODEC_LIB} ${FFMPEG_AVDEVICE_LIB} ${FFMPEG_AVFORMAT_LIB} ${FFMPEG_AVUTIL_LIB} ${FFMPEG_SWSCALE_LIB} CACHE INTERNAL "FFMPEG Libraries" FORCE)
