cmake_minimum_required(VERSION 2.6)
PROJECT(PARTICLE_MESHER)


IF(BUILD_BIOMESH3D)
  IF(COMMAND CMAKE_POLICY)
    CMAKE_POLICY(VERSION 2.6)
  ENDIF(COMMAND CMAKE_POLICY)
ENDIF(BUILD_BIOMESH3D)

IF(BUILD_STATIC_THIRDPARTY)
  SET(BUILD_SHARED_LIBS OFF)
ENDIF(BUILD_STATIC_THIRDPARTY)

# The BioMesh3D pipeline uses Teem configured for the SCIRun build.
IF(BUILD_BIOMESH3D)
  SET(TEEM_INCLUDE_DIRS ${SCI_TEEM_INCLUDE})
  SET(TEEM_LIBRARIES ${SCI_TEEM_LIBRARY} ${SCI_PNG_LIBRARY} ${SCI_ZLIB_LIBRARY})
  SET(TEEM_LIBRARY_DIRS ${CMAKE_LIBRARY_OUTPUT_DIRECTORY})

  IF(CMAKE_HAVE_UNISTD_H)
    ADD_DEFINITIONS(-DHAVE_UNISTD_H)
  ENDIF(CMAKE_HAVE_UNISTD_H)

  IF(WIN32 AND MSVC)
    # Bind application to the current version of the VC libraries
    ADD_DEFINITIONS(-D_BIND_TO_CURRENT_VCLIBS_VERSION) 

    # MSVC level 3 warnings are a little ridiculous
    SET(CMAKE_CXX_WARNING_LEVEL 1)
    IF(CMAKE_CXX_FLAGS MATCHES "/W[0-4]")
      STRING(REGEX REPLACE "/W[0-4]" "/W1"
              CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS}")
    ELSE(CMAKE_CXX_FLAGS MATCHES "/W[0-4]")
      SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} /W1")
    ENDIF(CMAKE_CXX_FLAGS MATCHES "/W[0-4]")
  ENDIF(WIN32 AND MSVC)

ELSE(BUILD_BIOMESH3D)
  FIND_PACKAGE(TEEM REQUIRED)
ENDIF(BUILD_BIOMESH3D)

INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/util)

ADD_SUBDIRECTORY(particleutil)
ADD_SUBDIRECTORY(multisurfaces)
ADD_SUBDIRECTORY(util)
ADD_SUBDIRECTORY(sizingfield)
ADD_SUBDIRECTORY(pts2node)
ADD_SUBDIRECTORY(removetets)
